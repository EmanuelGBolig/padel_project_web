{% extends "base.html" %}
{% load static %}
{% load torneo_extras %}
{% block title %}
    Mis Torneos - TodoPadel
{% endblock title %}
{% block content_title %}
    <h1 class="text-3xl md:text-4xl font-bold text-base-content mb-2 flex items-center gap-3">
        <svg xmlns="http://www.w3.org/2000/svg"
             class="h-8 w-8 text-primary"
             fill="none"
             viewBox="0 0 24 24"
             stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
        </svg>
        Mis Torneos
    </h1>
    <p class="text-base-content/70">Gestioná y revisá todos los torneos en los que participás.</p>
{% endblock content_title %}
{% block content %}
    <div class="space-y-12">
        <!-- Pestañas para segmentar los torneos -->
        <div class="tabs tabs-lifted tabs-lg mb-0">
            <button id="btn-tab-juego"
                    class="tab font-bold {% if torneos_en_juego or not torneos_abiertos %}tab-active{% endif %}"
                    onclick="showTab('tab-juego')">En Juego ({{ torneos_en_juego|length }})</button>
            <button id="btn-tab-insc"
                    class="tab font-bold {% if torneos_abiertos and not torneos_en_juego %}tab-active{% endif %}"
                    onclick="showTab('tab-insc')">Inscripciones ({{ torneos_abiertos|length }})</button>
            <button id="btn-tab-hist" class="tab font-bold" onclick="showTab('tab-hist')">
                Historial ({{ torneos_finalizados|length }})
            </button>
        </div>
        <!-- Contenedores -->
        <div class="bg-base-100 border border-base-300 rounded-b-box rounded-tr-box p-2 md:p-6 shadow-sm">
            <!-- PANEL: EN JUEGO -->
            <div id="tab-juego"
                 class="tab-panel {% if not torneos_en_juego and torneos_abiertos %}hidden{% endif %}">
                {% if torneos_en_juego %}
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        {% for torneo in torneos_en_juego %}
                            {% include "torneos/partials/torneo_card.html" with torneo=torneo %}
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-12 px-4 rounded-3xl bg-base-200/50 border-2 border-dashed border-base-300">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-base-100 shadow-sm mb-4 text-base-content/30">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 class="h-8 w-8"
                                 fill="none"
                                 viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-base-content mb-2">Sin torneos en juego</h3>
                        <p class="text-base-content/60 max-w-sm mx-auto">
                            Actualmente no estás disputando ningún torneo. ¡Revisá las inscripciones abiertas para sumarte a uno!
                        </p>
                    </div>
                {% endif %}
            </div>
            <!-- PANEL: INSCRIPCIONES -->
            <div id="tab-insc"
                 class="tab-panel {% if torneos_en_juego or not torneos_abiertos %}hidden{% endif %}">
                {% if torneos_abiertos %}
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        {% for torneo in torneos_abiertos %}
                            {% include "torneos/partials/torneo_card.html" with torneo=torneo %}
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-12 px-4 rounded-3xl bg-base-200/50 border-2 border-dashed border-base-300">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-base-100 shadow-sm mb-4 text-base-content/30">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 class="h-8 w-8"
                                 fill="none"
                                 viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-base-content mb-2">No estás inscripto en torneos abiertos</h3>
                        <p class="text-base-content/60 max-w-sm mx-auto mb-6">
                            No tenés inscripciones activas en torneos que estén por comenzar.
                        </p>
                        <a href="{% url 'torneos:abierto_list' %}"
                           class="btn btn-primary shadow-sm hover:shadow-md transition-shadow">
                            Ver Torneos Disponibles
                        </a>
                    </div>
                {% endif %}
            </div>
            <!-- PANEL: HISTORIAL -->
            <div id="tab-hist" class="tab-panel hidden">
                {% if torneos_finalizados %}
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        {% for torneo in torneos_finalizados %}
                            {% include "torneos/partials/torneo_card.html" with torneo=torneo %}
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-12 px-4 rounded-3xl bg-base-200/50 border-2 border-dashed border-base-300">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-base-100 shadow-sm mb-4 text-base-content/30">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 class="h-8 w-8"
                                 fill="none"
                                 viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-base-content mb-2">Tu historial está vacío</h3>
                        <p class="text-base-content/60 max-w-sm mx-auto">
                            Cuando termines de participar en algun torneo, va a aparecer reflejado acá.
                        </p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    <!-- Script de Pestañas -->
    <script>
        function showTab(tabId) {
            document.querySelectorAll('.tab-panel').forEach(function(el) {
                el.classList.add('hidden');
            });
            document.getElementById(tabId).classList.remove('hidden');
            
            document.querySelectorAll('.tab').forEach(function(el) {
                el.classList.remove('tab-active');
            });
            document.getElementById('btn-' + tabId).classList.add('tab-active');
        }
    </script>
{% endblock content %}
